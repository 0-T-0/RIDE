*** Settings ***
Resource        atest_resources.txt

*** Keywords ***
Add Data To Row
    [Arguments]  ${row}  @{cells}
    ${len} =  Get Length  ${cells}
    : FOR  ${index}  IN RANGE  ${len}
    \  Click Editor Row And Column  ${row}  ${index+1}
    \  Send  @{cells}[${index}]

Click Editor Row And Column
    [Arguments]  ${row}=1  ${column}=1
    [Documentation]  Row and column start from 1.
    Win Activate  RIDE
    Control Focus  RIDE  ${EMPTY}  wxWindowClass6
    Send  {LEFT 25}
    Send  {UP 25}
    Send  {RIGHT ${column}}
    Send  {DOWN ${row}}
    # Column and row start from 1 and these rows remove those extra moves.
    # Passing value 0 to Send does not work, so indexing columns and rows from 0 is no better.
    Send  {LEFT 1}
    Send  {UP 1}

Select Row From Editor
    [Arguments]  ${row}
    Comment  Win Activate  RIDE
    ${y} =  Evaluate  (${row}-1)*22+10
    Control Click  RIDE  ${EMPTY}  wxWindowClass3  nX=5  nY=${y}

Select Rows From Editor
    [Arguments]  @{rows}
    FAIL  Not working
    Win Activate  RIDE
    Send  {CTRLDOWN}
    : FOR  ${row}  IN  @{rows}
    \  Run Keyword And Continue On Failure  Select Row From Editor  ${row}
    Send  {CTRLUP}

Create User Keyword
    Select From Context Menu  0

Get Arguments
    ${value} =  Get From Editor  Button3  Arguments
    [Return]  ${value}

Set Documentation
    [Arguments]  ${text}
    Set To Editor  Button1  Documentation  ${text}

Set To Editor
    [Arguments]  ${button}  ${dialog name}  ${value}  ${comment}=${NONE}
    Control Click  RIDE  ${EMPTY}  ${button}
    Wait For Active Window  ${dialog name}
    Control Set Text  ${dialog name}  ${EMPTY}  Edit1  ${value}
    Run Keyword If  """${comment}""" != """None"""  Control Set Text  ${dialog name}  ${EMPTY}  Edit2  ${comment}
    Control Click  ${dialog name}  ${EMPTY}  Button1

Get From Editor
    [Arguments]  ${button}  ${dialog name}
    Control Click  RIDE  ${EMPTY}  ${button}
    Wait For Active Window  ${dialog name}
    ${value} =  Control Get Text  ${dialog name}  ${EMPTY}  Edit1
    Control Click  ${dialog name}  ${EMPTY}  Button2
    [Return]  ${value}

